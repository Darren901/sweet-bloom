import{U as M}from"./UserBanner-W9iQe3Ey.js";import{s as P}from"./statusStore-D8qcawhQ.js";import{c as y}from"./cartStore-2MwUBDgE.js";import{_ as C,o as n,c as i,F as h,j as B,b as t,t as a,l as v,m as w,a as s,e as k,r as m,n as u,w as F,v as j,f as q}from"./index-CywCkABC.js";import{o as A}from"./orderStore-Dg64RHCE.js";import{U as D}from"./UserProductSwiper-BwycGKhG.js";import{c as L}from"./changeProductMixins-ChoQM1LL.js";import"./navigation-Blg5l8eB.js";import"./product-service-CRQKdMmW.js";const O={props:["cart"]},E={class:"border p-4 mb-4"},H={class:"d-flex mb-3"},G=["src"],I={class:"w-100"},z={class:"d-flex justify-content-between"},W={class:"mb-0 fw-bold text-secondary"},Y={class:"mb-0"},J={key:0},K={class:"mb-0 text-muted"},Q={class:"mb-0 text-success"},R={key:1,class:"mb-0"},X={class:"table mt-4 border-top border-bottom text-muted"},Z={key:0,class:"text-end border-0 px-0 pt-4"},tt={key:1,class:"text-end border-0 px-0 pt-4"},et={class:"d-flex justify-content-between mt-4"},st={class:"mb-0 h4 fw-bold"},ot={class:"mb-0 h4 fw-bold"};function lt(c,e,l,U,o,_){return n(),i("div",E,[(n(!0),i(h,null,B(l.cart.carts,r=>(n(),i("div",H,[t("img",{src:r.product.imageUrl,alt:"",class:"me-2",style:{width:"100px",height:"70px","object-fit":"cover",overflow:"hidden"}},null,8,G),t("div",I,[t("div",z,[t("div",null,[t("p",W,a(r.product.title),1),t("p",Y,"數量: "+a(r.qty)+" "+a(r.product.unit),1)]),r.coupon?(n(),i("div",J,[t("del",K,"NT$"+a(this.$filters.currency(r.total)),1),t("p",Q," NT$"+a(this.$filters.currency(r.final_total.toFixed(0))),1)])):(n(),i("p",R,"NT$"+a(this.$filters.currency(r.total)),1))])])]))),256)),t("table",X,[t("tbody",null,[t("tr",null,[e[0]||(e[0]=t("th",{class:"border-0 px-0 pt-4 font-weight-normal"},"小計",-1)),l.cart.total===l.cart.final_total?(n(),i("td",Z,[t("span",null,"NT$"+a(this.$filters.currency(l.cart.total)),1)])):(n(),i("td",tt,[t("del",null,"NT$"+a(this.$filters.currency(l.cart.total)),1)]))]),e[1]||(e[1]=t("tr",null,[t("th",{class:"border-0 px-0 pt-0 pb-4 font-weight-normal"},"付款方式"),t("td",{class:"text-end border-0 px-0 pt-0 pb-4"},"ApplePay")],-1))])]),t("div",et,[l.cart.total===l.cart.final_total?(n(),i(h,{key:0},[e[2]||(e[2]=t("p",{class:"mb-0 h4 fw-bold"},"總計",-1)),t("p",st,"NT$"+a(this.$filters.currency(l.cart.total)),1)],64)):(n(),i(h,{key:1},[e[3]||(e[3]=t("p",{class:"mb-0 h4 fw-bold text-success"},"優惠價",-1)),t("p",ot,"NT$"+a(this.$filters.currency(l.cart.final_total.toFixed(0))),1)],64))])])}const rt=C(O,[["render",lt]]),at={data(){return{user:{},message:""}},mixins:[L],methods:{...v(y,["getCart"]),...v(A,["sendOrder"]),async handleSubmitOrder(){try{let c=await this.sendOrder(this.user,this.message);this.user={},this.message="",this.$router.push(`/user/checkout/${c.data.orderId}`)}catch(c){console.log(c)}}},computed:{...w(y,["cart"]),...w(P,["isLoading"])},components:{UserBanner:M,UserCheckTable:rt,UserProductSwiper:D},created(){this.getCart()}},nt={class:"container mt-md-5 mt-3 mb-3"},it={class:"row flex-row justify-content-center p-3 g-md-5 g-3"},dt={class:"col-md-5"},ct={class:"col-md-6"},mt={class:"sticky-top"},ut={class:"mb-0"},pt={class:"mb-2"},bt={class:"mb-2"},ft={class:"mb-2"},ht={class:"mb-2"},_t={class:"d-flex flex-md-row mt-4 justify-content-between align-items-md-center w-100"};function xt(c,e,l,U,o,_){const r=m("Loading"),$=m("UserBanner"),V=m("UserCheckTable"),p=m("Field"),b=m("ErrorMessage"),N=m("router-link"),S=m("Form"),T=m("UserProductSwiper");return n(),i(h,null,[s(r,{active:c.isLoading},null,8,["active"]),s($,{title:"確認訂單",imageUrl:"https://images.unsplash.com/photo-1519340333755-56e9c1d04579?q=80&w=2070&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D"}),t("div",nt,[t("div",it,[t("div",dt,[e[5]||(e[5]=t("h5",{class:"text-start text-dark"},"確認訂單內容",-1)),s(V,{cart:this.cart},null,8,["cart"])]),t("div",ct,[t("div",mt,[e[12]||(e[12]=t("h5",{class:"text-start text-dark"},"訂購人資訊",-1)),s(S,{class:"p-3 border",onSubmit:_.handleSubmitOrder},{default:k(({errors:f})=>{var x,g;return[t("div",ut,[e[6]||(e[6]=t("label",{for:"ContactMail",class:"text-muted mb-0"},"Email",-1)),s(p,{type:"email",name:"email",class:u(["form-control bg-light",{"is-invalid":f.email}]),id:"ContactMail",placeholder:"請輸入信箱",rules:"email|required",modelValue:o.user.email,"onUpdate:modelValue":e[0]||(e[0]=d=>o.user.email=d)},null,8,["class","modelValue"]),s(b,{name:"email",class:"invalid-feedback"})]),t("div",pt,[e[7]||(e[7]=t("label",{for:"ContactName",class:"text-muted mb-0"},"姓名",-1)),s(p,{type:"text",class:u(["form-control bg-light",{"is-invalid":f.姓名}]),id:"ContactName",placeholder:"請輸入姓名",name:"姓名",rules:"required",modelValue:o.user.name,"onUpdate:modelValue":e[1]||(e[1]=d=>o.user.name=d)},null,8,["class","modelValue"]),s(b,{name:"姓名",class:"invalid-feedback"})]),t("div",bt,[e[8]||(e[8]=t("label",{for:"ContactPhone",class:"text-muted mb-0"},"電話",-1)),s(p,{type:"text",class:u(["form-control bg-light",{"is-invalid":f.電話}]),id:"ContactPhone",name:"電話",rules:{required:!0,regex:/^09[0-9]{8}$/},placeholder:"請輸入電話",modelValue:o.user.tel,"onUpdate:modelValue":e[2]||(e[2]=d=>o.user.tel=d)},null,8,["class","modelValue"]),s(b,{name:"電話",class:"invalid-feedback"})]),t("div",ft,[e[9]||(e[9]=t("label",{for:"ContactAddress",class:"text-muted mb-0"},"地址",-1)),s(p,{type:"text",class:u(["form-control bg-light",{"is-invalid":f.地址}]),name:"地址",id:"ContactAddress",placeholder:"請輸入地址",rules:"required",modelValue:o.user.address,"onUpdate:modelValue":e[3]||(e[3]=d=>o.user.address=d)},null,8,["class","modelValue"]),s(b,{name:"地址",class:"invalid-feedback"})]),t("div",ht,[e[10]||(e[10]=t("label",{for:"ContactMessage",class:"text-muted mb-0"},"備註",-1)),F(t("textarea",{class:"form-control bg-light shadow-primary",rows:"3",id:"ContactMessage",placeholder:"請填寫想要備註的內容","onUpdate:modelValue":e[4]||(e[4]=d=>o.message=d)},null,512),[[j,o.message]])]),t("div",_t,[s(N,{to:"/user/cart",class:"text-primary mt-md-0 mt-3 text-decoration-none link-secondary"},{default:k(()=>e[11]||(e[11]=[t("i",{class:"bi bi-chevron-left"},null,-1),q(" 回到購物車")])),_:1}),t("button",{type:"submit",class:u(["btn btn-primary px-4 py-2 text-light",{disabled:((g=(x=c.cart)==null?void 0:x.carts)==null?void 0:g.length)===0}])}," 送出訂單 ",2)])]}),_:1},8,["onSubmit"])])])]),s(T,{onChangeProduct:c.changeProduct},null,8,["onChangeProduct"])])],64)}const Nt=C(at,[["render",xt],["__scopeId","data-v-5be3466d"]]);export{Nt as default};
