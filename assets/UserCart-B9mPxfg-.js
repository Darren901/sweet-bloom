import{U as P}from"./UserBanner-Bmw7c-Bn.js";import{s as S}from"./statusStore-AM89yjSO.js";import{c as u}from"./cartStore-BaomHWyO.js";import{y as q,_ as B,l as y,m as x,c as n,a as r,b as t,e as i,h as T,F as p,j as V,t as d,n as I,w,v as k,r as b,o as a,f as c,k as M,d as $}from"./index-Os4zg95r.js";import{U as D}from"./UserProductSwiper-BUEvpBb1.js";import{c as A}from"./changeProductMixins-ChoQM1LL.js";import"./navigation-CkDX2Rft.js";import"./product-service-to-F5UUU.js";const j="https://vue3-course-api.hexschool.io/api/darrenapi";class F{useCoupon(o){return q.post(`${j}/coupon`,{data:{code:o}})}}const H=new F,G={data(){return{couponCode:""}},mixins:[A],methods:{...y(u,["getCart"]),...y(u,["deleteOneProduct"]),...y(u,["updateCartCount"]),async handleCoupon(){try{let e=await H.useCoupon(this.couponCode);this.$httpMessageState(e,"套用優惠券"),this.couponCode="",this.getCart()}catch(e){console.log(e)}}},computed:{...x(S,["isLoading","cartLoadingItem"]),...x(u,["cart"])},components:{UserBanner:P,UserProductSwiper:D},created(){this.getCart()}},O={class:"container"},z={class:"mt-5 ps-2"},E={"aria-label":"breadcrumb "},R={class:"breadcrumb"},W={class:"breadcrumb-item"},Y={class:"breadcrumb-item"},J={class:"row my-4"},K={class:"col-md-8"},Q={key:0},X={class:"empty-cart-container text-center py-5"},Z={key:1,class:"table-responsive"},tt={class:"table align-middle"},ot=["src"],st={key:0,class:"text-success fw-normal d-block"},et={class:"input-group w-50 w-sm-auto",style:{"min-width":"120px"}},nt=["disabled","onClick"],at=["disabled","onUpdate:modelValue","onChange"],rt=["disabled","onClick"],dt={key:0},lt={key:1},it={class:"text-success d-block"},ct=["disabled","onClick"],ut={key:0,class:"spinner-border text-primary spinner-border-sm me-1",role:"status"},pt={key:1,class:"bi bi-x-lg"},bt={class:"col-md-4"},mt={class:"sticky-top"},ht={class:"border p-4 mb-4"},yt={class:"table text-muted"},ft={key:0,class:"border-0 px-0 pt-4 text-end"},gt={key:1,class:"border-0 px-0 pt-4 text-end"},vt={class:"d-flex justify-content-between mt-4"},_t={class:"mb-0 h4 fw-bold text-dark"},Ct={class:"mb-0 h4 fw-bold"},xt={class:"input-group w-100 mb-3"},wt={class:"input-group-append"},kt=["disabled"];function $t(e,o,Lt,Ut,m,f){var g,v,_,C;const L=b("Loading"),U=b("UserBanner"),l=b("router-link"),N=b("UserProductSwiper");return a(),n(p,null,[r(L,{active:e.isLoading},null,8,["active"]),r(U,{title:"購物車","image-url":"https://images.unsplash.com/photo-1488477081514-c6da99e85213?q=80&w=1974&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D"}),t("div",O,[t("div",z,[t("nav",E,[t("ol",R,[t("li",W,[r(l,{class:"text-decoration-none text-primary",to:"/user/index"},{default:i(()=>o[2]||(o[2]=[c("首頁")])),_:1})]),t("li",Y,[r(l,{to:"/user/products",class:"text-decoration-none text-primary"},{default:i(()=>o[3]||(o[3]=[c("所有商品")])),_:1})]),o[4]||(o[4]=t("li",{class:"breadcrumb-item active text-secondary","aria-current":"page"},"購物車",-1))])])]),t("div",J,[t("div",K,[((v=(g=e.cart)==null?void 0:g.carts)==null?void 0:v.length)===0?(a(),n("div",Q,[t("div",X,[o[6]||(o[6]=T('<div class="empty-cart-icon mb-4 pe-4" data-v-6bd6a74c><svg xmlns="http://www.w3.org/2000/svg" width="120" height="120" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" class="text-gray-400" data-v-6bd6a74c><circle cx="9" cy="21" r="1" data-v-6bd6a74c></circle><circle cx="20" cy="21" r="1" data-v-6bd6a74c></circle><path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6" data-v-6bd6a74c></path></svg></div><h4 class="mb-3" data-v-6bd6a74c>您的購物車還是空的</h4><p class="text-muted mb-4" data-v-6bd6a74c>趕快來挑選喜歡的商品吧！</p>',3)),r(l,{to:"/user/products",class:"btn btn-primary btn-lg px-5 text-light"},{default:i(()=>o[5]||(o[5]=[c(" 開始購物 ")])),_:1})])])):(a(),n("div",Z,[t("table",tt,[o[10]||(o[10]=t("thead",{class:"text-primary"},[t("tr",null,[t("th",null,"商品名稱"),t("th",null,"數量"),t("th",null,"價格"),t("th",null,"操作")])],-1)),(a(!0),n(p,null,V(e.cart.carts,s=>(a(),n("tbody",{key:s.id},[t("tr",null,[t("td",null,[t("img",{src:s.product.imageUrl,style:{width:"150px",height:"150px","object-fit":"cover"}},null,8,ot),r(l,{to:`/user/product/${s.product.id}`,class:"mb-0 fw-bold ms-3 d-inline-block text-secondary text-decoration-none link-primary"},{default:i(()=>[c(d(s.product.title)+" ",1),s.coupon?(a(),n("span",st,"已套用優惠券")):M("",!0)]),_:2},1032,["to"])]),t("td",null,[t("div",et,[t("button",{class:"btn btn-outline-dark border-0 py-2",disabled:s.qty<=1||e.cartLoadingItem===s.id,type:"button",id:"button-addon1",onClick:$(()=>{s.qty--,e.updateCartCount(s.id,s.qty)},["prevent"])},o[7]||(o[7]=[t("i",{class:"bi bi-dash"},null,-1)]),8,nt),w(t("input",{type:"text",disabled:e.cartLoadingItem===s.id,class:"form-control border-0 text-center bg-light text-dark shadow-none",placeholder:"","onUpdate:modelValue":h=>s.qty=h,onChange:h=>e.updateCartCount(s.id,s.qty)},null,40,at),[[k,s.qty,void 0,{number:!0}]]),t("button",{class:"btn btn-outline-dark border-0 py-2",type:"button",id:"button-addon1",disabled:e.cartLoadingItem===s.id,onClick:$(()=>{s.qty++,e.updateCartCount(s.id,s.qty)},["prevent"])},o[8]||(o[8]=[t("i",{class:"bi bi-plus"},null,-1)]),8,rt)])]),s.total===s.final_total?(a(),n("td",dt,"NT$"+d(s.total),1)):(a(),n("td",lt,[t("del",null,"NT$"+d(this.$filters.currency(s.total)),1),t("span",it,"NT$"+d(this.$filters.currency(s.final_total.toFixed(0))),1)])),t("td",null,[t("button",{class:"btn btn-outline-primary border-0",disabled:e.cartLoadingItem===s.id,onClick:h=>e.deleteOneProduct(s.id)},[e.cartLoadingItem===s.id?(a(),n("div",ut,o[9]||(o[9]=[t("span",{class:"visually-hidden"},"Loading...",-1)]))):(a(),n("i",pt))],8,ct)])])]))),128))])]))]),t("div",bt,[t("div",mt,[t("div",ht,[o[16]||(o[16]=t("h4",{class:"mb-4 text-primary"},"訂單詳情",-1)),t("table",yt,[t("tbody",null,[t("tr",null,[o[11]||(o[11]=t("td",{class:"border-0 px-0 pt-4 text-start fw-bold"},"小計",-1)),e.cart.final_total!==e.cart.total?(a(),n("td",ft,[t("del",null,"NT$"+d(this.$filters.currency(e.cart.total)),1)])):(a(),n("td",gt," NT$"+d(this.$filters.currency(e.cart.total)),1))]),o[12]||(o[12]=t("tr",null,[t("td",{class:"border-0 px-0 text-start fw-bold"},"付款方式"),t("td",{class:"border-0 px-0 text-end"},"Apple Pay")],-1))])]),t("div",vt,[e.cart.final_total!==e.cart.total?(a(),n(p,{key:0},[o[13]||(o[13]=t("p",{class:"mb-0 h4 fw-bold text-success"},"優惠價",-1)),t("p",_t," NT$"+d(this.$filters.currency(e.cart.final_total.toFixed(0))),1)],64)):(a(),n(p,{key:1},[o[14]||(o[14]=t("p",{class:"mb-0 h4 fw-bold"},"總計",-1)),t("p",Ct,"NT$"+d(this.$filters.currency(e.cart.final_total)),1)],64))]),r(l,{to:"/user/checkout",class:I(["btn btn-outline-primary w-100 mt-4",{disabled:((C=(_=e.cart)==null?void 0:_.carts)==null?void 0:C.length)===0}])},{default:i(()=>o[15]||(o[15]=[c("前往付款")])),_:1},8,["class"])]),t("div",xt,[w(t("input",{type:"text",class:"form-control rounded-0 border-bottom border-top-0 border-start-0 border-end-0 shadow-none bg-light text-primary",placeholder:"Coupon Code","onUpdate:modelValue":o[0]||(o[0]=s=>m.couponCode=s)},null,512),[[k,m.couponCode]]),t("div",wt,[t("button",{class:"btn btn-outline-none border-bottom rounded-0 border-0",type:"button",id:"button-addon2",onClick:o[1]||(o[1]=(...s)=>f.handleCoupon&&f.handleCoupon(...s)),disabled:m.couponCode===""},o[17]||(o[17]=[t("i",{class:"bi bi-send text-primary"},null,-1)]),8,kt)])])])])]),r(N,{onChangeProduct:e.changeProduct},null,8,["onChangeProduct"])])],64)}const Mt=B(G,[["render",$t],["__scopeId","data-v-6bd6a74c"]]);export{Mt as default};
